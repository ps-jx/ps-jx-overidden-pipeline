buildPack: gradle
pipelineConfig:
  pipelines:
    pullRequest:
      build:
        steps:
          - name: Create code coverage report
            command: |
              gradle jacocoTestReport
          - name: Upload code coverage report to GitHub
            agent:
              image: "ellerbrock/alpine-bash-curl-ssl:latest"
            env:
              - name: CODECOV_TOKEN
                valueFrom:
                  secretKeyRef:
                    name: code-cov
                    key: code-cov-token
            sh: curl -s https://codecov.io/bash | /bin/bash
